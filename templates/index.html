<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Симулятор дифракции - Френель и Фраунгофер</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(90deg, #00d4ff, #7b2cbf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-content {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: fit-content;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 1px solid rgba(0, 212, 255, 0.3);
            padding-bottom: 8px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            color: #b0b0b0;
            font-size: 0.9em;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #2a2a4a;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #7b2cbf);
            cursor: pointer;
        }

        input[type="number"], select {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: #e0e0e0;
            font-size: 14px;
        }

        select {
            cursor: pointer;
        }

        .value-display {
            text-align: right;
            color: #00d4ff;
            font-size: 0.85em;
            margin-top: 3px;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4ff, #7b2cbf);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .results-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-card h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #00d4ff;
        }

        .result-card.fresnel h3 {
            color: #ff6b6b;
        }

        .result-card.fraunhofer h3 {
            color: #4ecdc4;
        }

        .image-container {
            width: 100%;
            aspect-ratio: 1;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .placeholder {
            color: #555;
            font-size: 0.9em;
            text-align: center;
            padding: 20px;
        }

        .aperture-options {
            display: none;
        }

        .aperture-options.active {
            display: block;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        .file-input-label {
            display: block;
            padding: 10px;
            background: rgba(0, 212, 255, 0.2);
            border: 1px dashed rgba(0, 212, 255, 0.5);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-input-label:hover {
            background: rgba(0, 212, 255, 0.3);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 212, 255, 0.3);
            border-top-color: #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .info-panel {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            font-size: 0.85em;
        }

        .info-panel p {
            margin: 5px 0;
        }

        .info-panel span {
            color: #00d4ff;
        }

        .matrix-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 2px;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .matrix-cell {
            aspect-ratio: 1;
            background: #2a2a4a;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 2px;
        }

        .matrix-cell:hover {
            border-color: #00d4ff;
        }

        .matrix-cell.active {
            background: #ffffff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .matrix-buttons {
            display: flex;
            gap: 10px;
        }

        .matrix-buttons .btn {
            flex: 1;
            padding: 8px;
            font-size: 0.85em;
        }

        .theory-section {
            margin-top: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .theory-section h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
            background: linear-gradient(90deg, #00d4ff, #7b2cbf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .theory-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .theory-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            border-left: 4px solid #00d4ff;
        }

        .theory-card.fresnel-theory {
            border-left-color: #ff6b6b;
        }

        .theory-card.fraunhofer-theory {
            border-left-color: #4ecdc4;
        }

        .theory-card.general-theory {
            border-left-color: #7b2cbf;
        }

        .theory-card h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .theory-card.fresnel-theory h3 {
            color: #ff6b6b;
        }

        .theory-card.fraunhofer-theory h3 {
            color: #4ecdc4;
        }

        .theory-card.general-theory h3 {
            color: #7b2cbf;
        }

        .theory-card p {
            line-height: 1.6;
            margin-bottom: 10px;
            color: #b0b0b0;
        }

        .theory-card ul {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        .theory-card li {
            margin-bottom: 5px;
            color: #b0b0b0;
        }

        .formula {
            background: rgba(0, 212, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            text-align: center;
            margin: 15px 0;
            color: #00d4ff;
            font-size: 1.1em;
        }

        .highlight {
            color: #00d4ff;
            font-weight: bold;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .results-panel {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .results-panel {
                grid-template-columns: 1fr;
            }

            .theory-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Симулятор дифракции электронов</h1>

    <div class="main-content">
        <div class="control-panel">
            <div class="control-section">
                <h3>Тип апертуры</h3>
                <div class="control-group">
                    <select id="типАпертуры" onchange="обновитьОпцииАпертуры()">
                        <option value="одиночная">Одиночная щель</option>
                        <option value="двойная">Двойная щель</option>
                        <option value="тройная">Тройная щель</option>
                        <option value="круг">Круглое отверстие</option>
                        <option value="изображение">Из изображения</option>
                        <option value="матрица">Из матрицы</option>
                    </select>
                </div>

                <div id="опцииЩелей" class="aperture-options active">
                    <div class="control-group">
                        <label>Ширина щели (пиксели)</label>
                        <input type="range" id="ширинаЩели" min="2" max="100" value="20" oninput="обновитьЗначение('ширинаЩели')">
                        <div class="value-display" id="ширинаЩелиЗначение">20</div>
                    </div>
                    <div class="control-group" id="группаРазделения">
                        <label>Расстояние между щелями (пиксели)</label>
                        <input type="range" id="расстояниеЩелей" min="20" max="200" value="60" oninput="обновитьЗначение('расстояниеЩелей')">
                        <div class="value-display" id="расстояниеЩелейЗначение">60</div>
                    </div>
                </div>

                <div id="опцииКруга" class="aperture-options">
                    <div class="control-group">
                        <label>Радиус круга (пиксели)</label>
                        <input type="range" id="радиусКруга" min="5" max="150" value="40" oninput="обновитьЗначение('радиусКруга')">
                        <div class="value-display" id="радиусКругаЗначение">40</div>
                    </div>
                </div>

                <div id="опцииИзображения" class="aperture-options">
                    <div class="control-group">
                        <label>Загрузить изображение (белый = щель)</label>
                        <div class="file-input-wrapper">
                            <span class="file-input-label" id="меткаФайла">Нажмите для выбора изображения</span>
                            <input type="file" id="вводИзображения" accept="image/*" onchange="обработатьЗагрузкуИзображения(event)">
                        </div>
                    </div>
                </div>

                <div id="опцииМатрицы" class="aperture-options">
                    <div class="control-group">
                        <label>Нажмите на ячейки для создания апертуры</label>
                        <div class="matrix-grid" id="сеткаМатрицы"></div>
                        <div class="matrix-buttons">
                            <button class="btn btn-secondary" onclick="очиститьМатрицу()">Очистить</button>
                            <button class="btn btn-secondary" onclick="заполнитьВсё()">Заполнить всё</button>
                            <button class="btn btn-secondary" onclick="инвертировать()">Инвертировать</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-section">
                <h3>Физические параметры</h3>
                <div class="control-group">
                    <label>Расстояние до экрана (м)</label>
                    <input type="range" id="расстояниеЭкрана" min="0.01" max="10" step="0.01" value="1" oninput="обновитьЗначение('расстояниеЭкрана')">
                    <div class="value-display" id="расстояниеЭкранаЗначение">1.00 м</div>
                </div>

                <div class="control-group">
                    <label>Количество электронов</label>
                    <input type="range" id="количествоЭлектронов" min="10000" max="1000000" step="10000" value="100000" oninput="обновитьЗначение('количествоЭлектронов')">
                    <div class="value-display" id="количествоЭлектроновЗначение">100 000</div>
                </div>

                <div class="control-group">
                    <label>Длина волны (пм)</label>
                    <input type="range" id="длинаВолны" min="1" max="100" value="5" oninput="обновитьЗначение('длинаВолны')">
                    <div class="value-display" id="длинаВолныЗначение">5 пм</div>
                </div>
            </div>

            <button class="btn btn-primary" id="кнопкаРасчёта" onclick="рассчитать()">
                Рассчитать дифракцию
            </button>

            <div class="loading" id="загрузка">
                <div class="spinner"></div>
                <p>Расчёт дифракционных картин...</p>
            </div>

            <div class="info-panel" id="панельИнфо" style="display: none;">
                <p>Число Френеля: <span id="числоФренеля">-</span></p>
                <p>Электронов: <span id="счётчикЭлектронов">-</span></p>
                <p>Расстояние: <span id="информацияРасстояния">-</span></p>
            </div>
        </div>

        <div class="results-panel">
            <div class="result-card">
                <h3>Апертура</h3>
                <div class="image-container">
                    <img id="изображениеАпертуры" style="display: none;">
                    <span class="placeholder" id="заглушкаАпертуры">Апертура появится здесь</span>
                </div>
            </div>

            <div class="result-card fresnel">
                <h3>Дифракция Френеля (ближняя зона)</h3>
                <div class="image-container">
                    <img id="изображениеФренеля" style="display: none;">
                    <span class="placeholder" id="заглушкаФренеля">Картина Френеля появится здесь</span>
                </div>
            </div>

            <div class="result-card fraunhofer">
                <h3>Дифракция Фраунгофера (дальняя зона)</h3>
                <div class="image-container">
                    <img id="изображениеФраунгофера" style="display: none;">
                    <span class="placeholder" id="заглушкаФраунгофера">Картина Фраунгофера появится здесь</span>
                </div>
            </div>
        </div>
    </div>

    <div class="theory-section">
        <h2>Теория дифракции</h2>

        <div class="theory-cards">
            <div class="theory-card general-theory">
                <h3>Что такое дифракция?</h3>
                <p>
                    <span class="highlight">Дифракция</span> — это явление огибания волнами препятствий
                    или отклонения волн при прохождении через отверстия.
                </p>
                <p>
                    Дифракция наблюдается, когда размеры препятствия или отверстия сравнимы
                    с длиной волны. Это явление доказывает волновую природу света и электронов.
                </p>
                <p>
                    <span class="highlight">Принцип Гюйгенса-Френеля:</span> каждая точка волнового фронта
                    является источником вторичных сферических волн, а результирующее поле —
                    суперпозиция этих волн.
                </p>
            </div>

            <div class="theory-card fresnel-theory">
                <h3>Дифракция Френеля</h3>
                <p>
                    <span class="highlight">Дифракция Френеля</span> (ближняя зона) наблюдается,
                    когда источник или экран находятся на конечном расстоянии от препятствия.
                </p>
                <div class="formula">F = a² / (λ × L) > 1</div>
                <p>Где:</p>
                <ul>
                    <li><strong>F</strong> — число Френеля</li>
                    <li><strong>a</strong> — характерный размер апертуры</li>
                    <li><strong>λ</strong> — длина волны</li>
                    <li><strong>L</strong> — расстояние до экрана</li>
                </ul>
                <p>
                    В зоне Френеля дифракционная картина сложная и зависит от расстояния.
                    Волновой фронт нельзя считать плоским.
                </p>
            </div>

            <div class="theory-card fraunhofer-theory">
                <h3>Дифракция Фраунгофера</h3>
                <p>
                    <span class="highlight">Дифракция Фраунгофера</span> (дальняя зона) наблюдается,
                    когда и источник, и экран находятся на бесконечно большом расстоянии от препятствия.
                </p>
                <div class="formula">F = a² / (λ × L) << 1</div>
                <p>
                    В этом случае падающий и дифрагированный волновые фронты можно считать плоскими.
                </p>
                <p>
                    <span class="highlight">Важное свойство:</span> дифракционная картина Фраунгофера
                    является Фурье-образом функции пропускания апертуры!
                </p>
                <p>
                    Это позволяет легко вычислять картину с помощью быстрого преобразования Фурье (БПФ).
                </p>
            </div>

            <div class="theory-card">
                <h3>Дифракция электронов</h3>
                <p>
                    Электроны обладают волновыми свойствами. Их длина волны определяется
                    формулой де Бройля:
                </p>
                <div class="formula">λ = h / p = h / (m × v)</div>
                <p>Где:</p>
                <ul>
                    <li><strong>h</strong> — постоянная Планка</li>
                    <li><strong>p</strong> — импульс электрона</li>
                    <li><strong>m</strong> — масса электрона</li>
                    <li><strong>v</strong> — скорость электрона</li>
                </ul>
                <p>
                    Для электронов с энергией 100 кэВ длина волны составляет около 4 пикометров.
                </p>
            </div>

            <div class="theory-card">
                <h3>Одиночная щель</h3>
                <p>
                    При дифракции на одиночной щели шириной <strong>b</strong> минимумы
                    интенсивности наблюдаются при углах:
                </p>
                <div class="formula">sin(θ) = m × λ / b, m = ±1, ±2, ...</div>
                <p>
                    Центральный максимум в два раза шире боковых.
                    Интенсивность боковых максимумов быстро убывает.
                </p>
                <p>
                    <span class="highlight">Чем уже щель</span>, тем шире дифракционная картина
                    (обратная зависимость).
                </p>
            </div>

            <div class="theory-card">
                <h3>Двойная щель</h3>
                <p>
                    Двойная щель создаёт комбинацию дифракции и интерференции.
                    Максимумы интерференции:
                </p>
                <div class="formula">d × sin(θ) = m × λ, m = 0, ±1, ±2, ...</div>
                <p>Где <strong>d</strong> — расстояние между центрами щелей.</p>
                <p>
                    Дифракционная картина от одиночной щели модулирует
                    интерференционную картину от двух источников.
                </p>
                <p>
                    <span class="highlight">Опыт Юнга</span> с двойной щелью исторически
                    доказал волновую природу света.
                </p>
            </div>

            <div class="theory-card">
                <h3>Круглое отверстие</h3>
                <p>
                    Дифракция на круглом отверстии создаёт характерную картину
                    <span class="highlight">колец Эйри</span>.
                </p>
                <p>
                    Угловой радиус первого тёмного кольца:
                </p>
                <div class="formula">sin(θ₁) ≈ 1.22 × λ / D</div>
                <p>Где <strong>D</strong> — диаметр отверстия.</p>
                <p>
                    Этот критерий определяет разрешающую способность оптических инструментов
                    (критерий Рэлея).
                </p>
            </div>

            <div class="theory-card general-theory">
                <h3>Статистика электронов</h3>
                <p>
                    В симуляторе учитывается квантовая природа электронов.
                    Каждый электрон — отдельная частица, но распределение
                    множества электронов формирует дифракционную картину.
                </p>
                <p>
                    <span class="highlight">Вероятность попадания</span> электрона в точку экрана
                    пропорциональна интенсивности волны в этой точке.
                </p>
                <p>
                    При малом числе электронов картина "зернистая",
                    при большом — становится непрерывной.
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    let загруженноеИзображение = null;
    let матрица = [];

    function инициализироватьМатрицу() {
        const сетка = document.getElementById('сеткаМатрицы');
        сетка.innerHTML = '';
        матрица = [];

        for (let i = 0; i < 10; i++) {
            матрица[i] = [];
            for (let j = 0; j < 10; j++) {
                матрица[i][j] = 0;
                const ячейка = document.createElement('div');
                ячейка.className = 'matrix-cell';
                ячейка.dataset.row = i;
                ячейка.dataset.col = j;
                ячейка.onclick = function() {
                    переключитьЯчейку(i, j, this);
                };
                сетка.appendChild(ячейка);
            }
        }
    }

    function переключитьЯчейку(row, col, элемент) {
        матрица[row][col] = матрица[row][col] === 0 ? 1 : 0;
        элемент.classList.toggle('active');
    }

    function очиститьМатрицу() {
        const ячейки = document.querySelectorAll('.matrix-cell');
        ячейки.forEach((ячейка, индекс) => {
            const row = Math.floor(индекс / 10);
            const col = индекс % 10;
            матрица[row][col] = 0;
            ячейка.classList.remove('active');
        });
    }

    function заполнитьВсё() {
        const ячейки = document.querySelectorAll('.matrix-cell');
        ячейки.forEach((ячейка, индекс) => {
            const row = Math.floor(индекс / 10);
            const col = индекс % 10;
            матрица[row][col] = 1;
            ячейка.classList.add('active');
        });
    }

    function инвертировать() {
        const ячейки = document.querySelectorAll('.matrix-cell');
        ячейки.forEach((ячейка, индекс) => {
            const row = Math.floor(индекс / 10);
            const col = индекс % 10;
            матрица[row][col] = матрица[row][col] === 0 ? 1 : 0;
            ячейка.classList.toggle('active');
        });
    }

    function обновитьЗначение(id) {
        const элемент = document.getElementById(id);
        const отображение = document.getElementById(id + 'Значение');

        if (id === 'расстояниеЭкрана') {
            отображение.textContent = parseFloat(элемент.value).toFixed(2) + ' м';
        } else if (id === 'количествоЭлектронов') {
            отображение.textContent = parseInt(элемент.value).toLocaleString('ru-RU');
        } else if (id === 'длинаВолны') {
            отображение.textContent = элемент.value + ' пм';
        } else {
            отображение.textContent = элемент.value;
        }
    }

    function обновитьОпцииАпертуры() {
        const типАпертуры = document.getElementById('типАпертуры').value;

        document.querySelectorAll('.aperture-options').forEach(el => {
            el.classList.remove('active');
        });

        if (типАпертуры === 'одиночная' || типАпертуры === 'двойная' || типАпертуры === 'тройная') {
            document.getElementById('опцииЩелей').classList.add('active');
            document.getElementById('группаРазделения').style.display =
                типАпертуры === 'одиночная' ? 'none' : 'block';
        } else if (типАпертуры === 'круг') {
            document.getElementById('опцииКруга').classList.add('active');
        } else if (типАпертуры === 'изображение') {
            document.getElementById('опцииИзображения').classList.add('active');
        } else if (типАпертуры === 'матрица') {
            document.getElementById('опцииМатрицы').classList.add('active');
        }
    }

    function обработатьЗагрузкуИзображения(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                загруженноеИзображение = e.target.result;
                document.getElementById('меткаФайла').textContent = file.name;
            };
            reader.readAsDataURL(file);
        }
    }

    async function рассчитать() {
        const кнопка = document.getElementById('кнопкаРасчёта');
        const загрузка = document.getElementById('загрузка');

        кнопка.disabled = true;
        загрузка.classList.add('active');

        const типАпертуры = document.getElementById('типАпертуры').value;

        const типыСоответствия = {
            'одиночная': 'single',
            'двойная': 'double',
            'тройная': 'triple',
            'круг': 'circle',
            'изображение': 'image',
            'матрица': 'matrix'
        };

        const данные = {
            aperture_type: типыСоответствия[типАпертуры],
            screen_distance: parseFloat(document.getElementById('расстояниеЭкрана').value),
            num_electrons: parseInt(document.getElementById('количествоЭлектронов').value),
            slit_width: parseInt(document.getElementById('ширинаЩели').value),
            slit_separation: parseInt(document.getElementById('расстояниеЩелей').value),
            circle_radius: parseInt(document.getElementById('радиусКруга').value),
            wavelength: parseFloat(document.getElementById('длинаВолны').value) * 1e-12,
            pixel_size: 1e-7,
            image_data: типАпертуры === 'изображение' ? загруженноеИзображение : null,
            matrix_data: типАпертуры === 'матрица' ? матрица : null
        };

        try {
            const ответ = await fetch('/calculate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(данные)
            });

            const результат = await ответ.json();

            if (результат.success) {
                показатьИзображение('изображениеАпертуры', 'заглушкаАпертуры', результат.aperture);
                показатьИзображение('изображениеФренеля', 'заглушкаФренеля', результат.fresnel);
                показатьИзображение('изображениеФраунгофера', 'заглушкаФраунгофера', результат.fraunhofer);

                document.getElementById('панельИнфо').style.display = 'block';
                document.getElementById('числоФренеля').textContent = результат.fresnel_number.toExponential(2);
                document.getElementById('счётчикЭлектронов').textContent = результат.info.electrons.toLocaleString('ru-RU');
                document.getElementById('информацияРасстояния').textContent = результат.info.distance.toFixed(2) + ' м';
            } else {
                alert('Ошибка: ' + результат.error);
            }
        } catch (ошибка) {
            alert('Ошибка соединения: ' + ошибка.message);
        }

        кнопка.disabled = false;
        загрузка.classList.remove('active');
    }

    function показатьИзображение(imgId, placeholderId, src) {
        const img = document.getElementById(imgId);
        const заглушка = document.getElementById(placeholderId);

        img.src = src;
        img.style.display = 'block';
        заглушка.style.display = 'none';
    }

    обновитьОпцииАпертуры();
    инициализироватьМатрицу();
</script>
</body>
</html>